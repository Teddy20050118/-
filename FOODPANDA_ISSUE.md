# ⚠️ Foodpanda 爬蟲遇到反爬蟲保護

## 問題

Foodpanda 有 reCAPTCHA 保護，阻止自動化爬蟲訪問。

```html
<div class="px-captcha-header">在我們繼續之前...</div>
<div class="px-captcha-message">請確認您是人類（而不是機器人）。</div>
```

這是 **PerimeterX Bot Defender + Google reCAPTCHA** 的組合防護。

## 🚫 無法繞過的原因

1. **reCAPTCHA Enterprise**：需要人類互動
2. **Bot Defender**：偵測 Playwright/Selenium
3. **法律風險**：繞過保護可能違反服務條款

## ✅ 可行的替代方案

### 方案 1：使用 Foodpanda 官方 API（如果有）

某些外送平台提供合作夥伴 API：
- 需要申請 API 金鑰
- 合法且穩定
- 資料完整

### 方案 2：改用其他沒有反爬蟲的平台

可能選項：
- **小型餐廳官網**：通常沒有複雜的反爬蟲
- **社群平台**：Facebook 粉絲頁、Instagram
- **Google 商家檔案**：有些餐廳會上傳菜單照片

### 方案 3：手動建立菜單資料庫（最實際）

**推薦流程：**

```
1. 建立菜單編輯器（前端介面）
   ↓
2. 管理員或使用者可以：
   - 手動輸入餐廳名稱
   - 新增菜品（名稱、價格、分類）
   - 上傳菜單照片（可選）
   ↓
3. 儲存到資料庫或 menu.json
   ↓
4. 點餐系統使用這些資料
```

### 方案 4：眾包模式（長期方案）

讓使用者貢獻菜單資料：
- 使用者可以新增/編輯餐廳菜單
- 投票或審核機制確保品質
- 類似 OpenStreetMap 的模式

### 方案 5：OCR + AI（技術方案）

從菜單照片提取資訊：
```python
# 使用 GPT-4 Vision
import openai

response = openai.ChatCompletion.create(
    model="gpt-4-vision-preview",
    messages=[{
        "role": "user",
        "content": [
            {"type": "text", "text": "請從這張菜單照片中提取所有菜品名稱和價格，以 JSON 格式回傳"},
            {"type": "image_url", "image_url": menu_image_url}
        ]
    }]
)
```

優勢：
- 可以處理 Google Maps 上的菜單照片
- 準確率高
- 不違反服務條款

劣勢：
- 需要 API 費用
- 處理時間較長

## 📝 建議實作：簡單菜單編輯器

讓我為你建立一個簡單的前端菜單編輯器：

### 特色功能

1. **快速新增餐廳**
   ```
   餐廳名稱：[史堤克牛排大甲店]
   地址：[台中市大甲區...]
   電話：[04-1234-5678]
   ```

2. **批次匯入菜單**
   ```
   經典牛排, 280
   雞腿排, 200
   豬排, 180
   紅茶, 20
   ```

3. **從文字解析**
   - 使用者貼上菜單文字
   - AI 自動解析成結構化資料

4. **匯出/匯入 JSON**
   - 方便備份和分享
   - 可以從其他來源匯入

### 使用流程

```
管理員 → 點擊「✏️ 編輯菜單」
        ↓
       選擇餐廳或新增餐廳
        ↓
       編輯菜單（手動或批次）
        ↓
       儲存到資料庫
        ↓
使用者 → 點餐時可以使用新菜單
```

## 🎯 當前建議

基於你的需求和限制，我建議：

1. **短期**：建立簡單的菜單編輯器
   - 管理員可以手動新增餐廳和菜單
   - 使用者可以建議新增（需審核）

2. **中期**：整合 OCR/AI
   - 使用者上傳菜單照片
   - AI 自動提取資訊
   - 管理員審核後加入系統

3. **長期**：建立眾包資料庫
   - 開放使用者貢獻菜單
   - 投票和審核機制
   - 建立台灣餐廳菜單資料庫

## 💡 現在要做什麼？

我可以幫你：

**選項 A：建立菜單編輯器**
- 前端介面讓你手動新增餐廳和菜單
- 支援批次匯入
- 直接整合到現有系統

**選項 B：整合 GPT-4 Vision OCR**
- 上傳菜單照片
- AI 自動提取菜品資訊
- 需要 OpenAI API key

**選項 C：簡化版本**
- 保留現有 menu.json 手動編輯
- 優化點餐對話流程
- 專注在推薦系統而非資料收集

你想選哪個方向？
